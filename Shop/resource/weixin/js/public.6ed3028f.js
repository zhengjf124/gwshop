window.console=window.console||function(){var e={};return e.log=e.warn=e.debug=e.info=e.error=e.time=e.dir=e.profile=e.clear=e.exception=e.trace=e.assert=function(){},e}(),+function(e,t){if("function"==typeof define&&define.amd)define(["jquery"],t);else if("object"==typeof exports)module.exports=t(require("jquery"));else{var n=t(jQuery);e.Pub=n}}(this,function(e){var t={debug:!0,clientRoot:"/weixin/",post:function(e,t,n,r){return this._ajax(e,t,n,r)},get:function(e,t,n,r){return this._ajax(e,t,n,r,"get")},_ajax:function(t,n,r,o,i){var a,s=this;e.isFunction(n)&&(o=o||r,r=n,n=void 0),t=this.getAbsoluteUrl(t),t.indexOf("_passport")===-1&&e.isPlainObject(n)&&!n.entriedCode?n=e.extend(this.getAuthInfo(),n):t.indexOf("_passport")===-1&&void 0===n&&(n=this.getAuthInfo()),e.isFunction(r)&&(a=function(e,t,n){e=s.catchCommonError(e),r(e,t,n)});var u=new e.Deferred,c="get"===i?e.get(t,n,a,o):e.post(t,n,a,o);c.then(function(e,t,n){e=s.catchCommonError(e),u.resolveWith(this,[e,t,n])},function(e,t,n){u.rejectWith(this,[e,t,n])});var f=u.promise();return f.abort=function(){c.abort(),u.reject("abort")},f},searchToObject:function(){var e,t,n=window.location.search.substring(1).split("&"),r={};for(t in n)""!==n[t]&&(e=n[t].split("="),r[decodeURIComponent(e[0])]=decodeURIComponent(e[1]));return r},countDown:function(t,n){var r=e(n).find(".day"),o=e(n).find(".hour"),i=e(n).find(".minute"),a=e(n).find(".second"),s=new Date(t).getTime(),u=(s-(new Date).getTime())/1e3,c=setInterval(function(){if(u>1){u-=1;var t=Math.floor(u/3600/24),n=Math.floor(u/3600%24),s=Math.floor(u/60%60),f=Math.floor(u%60);r&&e(r).text(t),e(o).text(n<10?"0"+n:n),e(i).text(s<10?"0"+s:s),e(a).text(f<10?"0"+f:f)}else clearInterval(c)},1e3)},toUnix:function(e){var t=e.replace(/:/g,"-");t=t.replace(/ /g,"-");var n=t.split("-"),r=new Date(Date.UTC(n[0],n[1]-1,n[2],n[3]-8,n[4],n[5]));return parseInt(r.getTime()/1e3)},toDatetime:function(e){var t=new Date(1e3*parseInt(e));return t.toLocaleString().replace(/年|月/g,"-").replace(/日/g," ")},deleteByValue:function(t,n){var r=e.grep(t,function(e,t){return e!=n});return r},deleteByIndex:function(t,n){var r=e.grep(t,function(e,t){return t!=n});return r},getUrlParam:function(e,t){var n=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),r=e.search.substr(1).match(n);return null!=r?unescape(r[2]):null},hasError:function(t){if(e.isPlainObject(t)&&t.code){var n=t.code;if("0"!==n)return!1}return!0},getAbsoluteUrl:function(e){return e},getAuthInfo:function(){var e=this.getSession("_passport"),t={_app:"shop",_platform:"weixin"};return e&&(t._passport=e),t},setAuthInfo:function(e){var t=e&&e._passport;this.setSession("_passport",t)},clearAuthInfo:function(){this.delSession("_passport")},catchCommonError:function(t){if(!e.isPlainObject(t)||!t.error_code)return t;var n=t.error_code;t.message;switch(n){case"10000":this._noLogin(t);break;case"10001":this._noLogin(t)}return t},parseUrl:function(e){var t=new RegExp(/^([^:]+):\/\/(?:([^:@]+)(?::([^@]+))?@)?([^:\/]+)(?:\:([0-9]*))?([^#\?]+)?(?:\?([^#]+))?(#.+)?$/gi),n=new RegExp("([^/]+)","g"),r=new RegExp("([^=&]+)=([^&]+)","g"),o={url:e},i=t.exec(e);if(null!==i){o.protocol=i[1]||"",o.user=i[2]||"",o.password=i[3]||"",o.subdomain=i[4]||"",o.domain=i[4]||"",o.port=i[5]||"",o.path=i[6]||"",o.query=i[7]||"",o.hash=i[8]||"";var a=o.path.match(n);o.parsePath=null===a?[]:a;var s={};return o.query.replace(r,function(e,t,n){return s[t]=n,e}),o.parseQuery=s,o}},getUrl:function(t,n){return t+=t.indexOf("?")!==-1?"&"+e.param(n):"?"+e.param(n)},getUrlParam:function(){var e=this.parseUrl(window.location.href);return e&&e.parseQuery},getSession:function(t){return sessionStorage?sessionStorage.getItem(t):e.cookie(t)},setSession:function(t,n){sessionStorage?sessionStorage.setItem(t,n):e.cookie(t,n,{path:"/"})},delSession:function(t){sessionStorage?sessionStorage.removeItem(t):e.removeCookie(t,{path:"/"})},getHtmlUrl:function(e){return this.clientRoot+e},_checkPageAuth:function(){var t=this,n=e("body").hasClass("hidden");if(!n)return!0;var r=this.getSession("_passport"),o={_app:"shop",_platform:"weixin",_passport:r},i="/Home/Login/check";e.ajax({async:!1,data:o,url:this.getAbsoluteUrl(i)}).then(function(e){t.catchCommonError(e)})},_noLogin:function(e){var t=e.url;t+=window.encodeURI(window.location.href),window.location.href=t},_setLoginData:function(){var e=window.location.href,t=this.getUrlParam(e);t&&t._passport&&this.setAuthInfo(t)}};return t._setLoginData(),t._checkPageAuth(),t});