!function(o,i,a,d){function s(){this.init()}s.prototype={params:{order_id:0,goods_id:0,order_sn:0,reason:"",type:0},init:function(){this.initParams(),this.getData()},initParams:function(){var o=Pub.searchToObject();this.params.order_id=o.id},getData:function(){var o=this;Pub.post("/Home/order/detail",{id:o.params.order_id},function(i){0==i.error_code&&(o.order_sn=i.data.order_sn,o.refundGoods(i.data.goods),o.initEvent())})},refundGoods:function(i){o("#refund_goods").empty();var a="";for(var d in i){a+='<li><div class="check" data-index="'+i[d].goods_id+'"><label><i>&#xe619;</i></label></div><div class="img"><a href="'+Pub.getHtmlUrl("html/goods/cont.fb80c266.html")+"?id="+i[d].goods_id+'"><span></span><img src="'+i[d].goods_img+'"></a></div><div class="info-refund"><div class="name"><a href="'+Pub.getHtmlUrl("html/goods/cont.fb80c266.html")+"?id="+i[d].goods_id+'"><h3>'+i[d].goods_name+'</h3></a></div><div class="sizes">';var s=i[d].spec_key_name.split(" ");for(var r in s)a+="<h4>"+s[r]+"</h4>";a+='</div><div class="price"><h4>￥ '+i[d].goods_price+"</h4><h3>X "+i[d].goods_num+"</h3></div></div></li>"}o("#refund_goods").append(a)},initEvent:function(){var i=this;o(".check").on("click",function(){o(".check").find("label").removeClass("active"),o(this).find("label").addClass("active");var a=o(this).attr("data-index");i.params.goods_id=a}),o("#refund_text").on("change",function(){var a=o(this).val();i.params.reason=a}),o("#submit_refund").on("click",function(){i.postData()})},postData:function(){var o=this;""==o.params.goods_id?cloud.msg("请选择商品！","50%",1500):""==o.params.reason?cloud.msg("请填写退款原因！","50%",1500):Pub.post("/Home/order/applyServer",{order_id:o.params.order_id,goods_id:o.params.goods_id,order_sn:o.params.order_sn,reason:o.params.reason,type:1},function(o){0==o.error_code?cloud.msg("你已成功申请退款,请等候我们处理！","50%",1500):20002==o.error_code&&cloud.msg("你已申请过退款,请耐心等候我们处理！","50%",1500)})}};new s}(jQuery,window,document);