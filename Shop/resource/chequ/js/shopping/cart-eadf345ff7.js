!function(t,i,a,s){var e=function(){this.init()};e.prototype={params:{offset:0,limit:0,cartIdAll:[],priceTotal:0,total:0,pages:0,countNum:0,countPrice:0,loadTemp:""},init:function(){this.initParams(),this.getDataInit(),this.initEvent()},initParams:function(){this.params.loadTemp='<div class="loader"><div class="loader-inner ball-spin-fade-loader"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div>'},getDataInit:function(){var t=this;Pub.post("/Home/Cart/index",{},function(i){0===parseInt(i.error_code)&&(t.cartList(i.data.list),t.params.total=i.data.count,t.params.pages=Math.ceil(t.params.total/t.params.limit),setTimeout(function(){t.dataEvent()},600))})},getData:function(){var i=this;t("#cart_list").html(i.params.loadTemp),Pub.post("/Home/Cart/index",{offset:i.params.offset,limit:i.params.limit},function(t){0===parseInt(t.error_code)&&i.cartList(t.data.list)})},cartList:function(i){if(i&&i.length>0){var a="";for(var s in i)if(i.hasOwnProperty(s)){a+='<li><div class="item1" data-index="'+i[s].id+'"><img src="../../images/icon_check-a4826ed315.png" class="img1"><img src="../../images/icon_check_ed-0e5cbbea5f.png" class="img2"></div><div class="item2"><div class="img"><a href="'+Pub.getHtmlUrl("html/goods/cont-4ec8c688d1.html")+"?id="+i[s].goods_id+'"><img src="'+i[s].goods_img+'"></a></div><div class="info"><div class="name"><a href="'+Pub.getHtmlUrl("html/goods/cont-4ec8c688d1.html")+"?id="+i[s].goods_id+'">'+i[s].goods_name+'</a></div><div class="brief">来自英国设计师richard c. evans的创意产品，但只要按照凹槽的纹路你就能...</div></div><div class="spec"><div class="spec-container">';var e=i[s].spec_key_name.split(" ");for(var c in e)a+="<p><strong>"+e[c]+"</strong></p>";a+='</div></div></div><div class="item3">'+i[s].goods_price+'</div><div class="item4"><div class="nums"><button class="btn-minus num-minus">&lt;</button><input type="text" value="'+i[s].goods_num+'"><button class="btn-plus num-plus" data-count="'+i[s].store_count+'">&gt;</button></div></div><div class="item5">'+(i[s].goods_num*i[s].goods_price).toFixed(2)+'</div><div class="item6"><a class="delect" data-index="'+i[s].id+'">删除</a></div></li>'}setTimeout(function(){t("#cart_list").html(a)},500)}},dataEvent:function(){var i=this;t(".item1").on("click",function(){var a=t(this).attr("data-index"),s=t(this).siblings(".item5").text();if(t(this).is(".active")){t(this).removeClass("active"),t("#check_all_down").removeClass("active"),t("#check_all label").removeClass("active");var a=t(this).attr("data-index");i.params.cartIdAll=Pub.deleteByValue(i.params.cartIdAll,a),i.params.priceTotal-=parseFloat(s),i.count()}else{t(this).addClass("active"),i.params.cartIdAll.push(a),i.params.priceTotal+=parseFloat(s),i.count();var e=t("#cart_list li");t("#count_num").text()==e.length&&(t("#check_all label").addClass("active"),t("#check_all_down").addClass("active"))}}),t("#check_all label").on("click",function(){t(this).is(".active")?(t(this).removeClass("active"),t(".item1").removeClass("active"),t("#check_all_down").removeClass("active"),i.count(),i.params.cartIdAll=[]):(t(this).addClass("active"),t(".item1").addClass("active"),t("#check_all_down").addClass("active"),i.count(),t(".item1").each(function(){if(t(this).is(".active"))var a=t(this).attr("data-index");i.params.cartIdAll.push(a)}))}),t("#check_all_down").on("click",function(){t(this).is(".active")?(t(this).removeClass("active"),t(".item1").removeClass("active"),t("#check_all label").removeClass("active"),i.count(),i.params.cartIdAll=[]):(t(this).addClass("active"),t(".item1").addClass("active"),t("#check_all label").addClass("active"),i.count(),t(".item1").each(function(){if(t(this).is(".active"))var a=t(this).attr("data-index");i.params.cartIdAll.push(a)}))}),t("#btn_balance").on("click",function(){return t("#count_num").text()>0?i.postData():cloud.explain("请您先选择商品，再结算！",2e3),!1}),t(".num-minus").on("click",function(){var a=t(this).siblings("input"),s=parseInt(a.val()),e=parseInt(t(this).parents(".item4").siblings(".item3").text()),c=t(this).parents(".item4").siblings(".item5");s>1?(a.val(--s),t(this).removeClass("disabled"),t(this).siblings(".num-plus").removeClass("disabled")):t(this).addClass("disabled"),c.text((e*s).toFixed(2)),i.count()}),t(".num-plus").on("click",function(){var a=t(this).siblings("input"),s=parseInt(a.val()),e=t(this).attr("data-count"),c=parseInt(t(this).parents(".item4").siblings(".item3").text()),n=t(this).parents(".item4").siblings(".item5");s===parseInt(e)?t(this).addClass("disabled"):a.val(++s),s>1&&t(this).siblings(".num-minus").removeClass("disabled"),n.text((c*s).toFixed(2)),i.count()}),t(".delect").on("click",function(){var a=this,s=t(this).attr("data-index");cloud.asked("您确定要删除吗？",function(){i.delectGoods(s,function(){t(a).parent().parent().fadeOut()})},function(){cloud.msg("您选择了“取消”！","50%",2e3)})}),t("#delect_all").on("click",function(){t(".item1").addClass("active"),t("#check_all label").addClass("active"),t("#check_all_down").addClass("active"),t(".item1").each(function(){if(t(this).is(".active"))var a=t(this).attr("data-index");i.params.cartIdAll.push(a)}),cloud.asked("您确定要清空吗？",function(){i.delectGoods(i.params.cartIdAll,function(){t("#cart_list").fadeOut()})},function(){cloud.msg("您选择了“取消”！","50%",2e3),t(".item1").removeClass("active"),t("#check_all label").removeClass("active"),t("#check_all_down").removeClass("active")})})},postData:function(){var t=this;Pub.post("/Home/order/confirm",{cart_id:t.params.cartIdAll},function(a){if(0===parseInt(a.error_code)){var s=JSON.stringify(t.params.cartIdAll);Pub.setSession("cartId",s),i.location.href=Pub.getHtmlUrl("html/shopping/balance-095e55510b.html")}})},count:function(){var i=0,a=0;t(".item1").each(function(){t(this).is(".active")&&(++i,a+=parseInt(t(this).siblings(".item5").text()))}),t("#count_num").text(i),t("#count_price").text(a.toFixed(2))},delectGoods:function(t,i){Pub.post("/Home/Cart/delete",{id:t},function(t){0===parseInt(t.error_code)&&cloud.explain("删除成功！","success",2e3)}),i()},initEvent:function(){t(".spec").on("hover",function(){t(this).is(".active")?(t(this).removeClass("active"),t(this).find(".btn-spec-change").hide(),t(this).find(".spec-change").fadeOut()):(t(this).addClass("active"),t(this).find(".btn-spec-change").show())}),t(".btn-spec-change").on("click",function(){t(this).siblings(".spec-change").slideDown()}),t(".btn-cancel").on("click",function(){t(".spec-change").hide()}),t("#to_index").on("click",function(){var t=Pub.getHtmlUrl("html/index.html");location.href=t}),t("#to_goods_list").on("click",function(){var t=Pub.getHtmlUrl("html/goods/list-a2943c3773.html");location.href=t})}};new e}(jQuery,window,document);