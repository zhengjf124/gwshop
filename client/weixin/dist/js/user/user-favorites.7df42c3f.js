!function(a,o){function i(){this.init()}i.prototype={params:{offset:0,limit:0,count:0},init:function(){this.initParams(),this.loadData()},initParams:function(){this.params.offset=0,this.params.limit=4},getData:function(a){var o=this;Pub.post("/Home/Collect/index",{offset:o.params.offset,limit:o.params.limit},function(i){0===i.error_code&&(o.params.count=i.data.count,o.params.offset+=o.params.limit,o.favoritesList(a,i.data.list),o.initEvent())})},favoritesList:function(o,i){var s=this,t="";if(i.length>0){for(var d in i)t+='<li><div class="favorites-cancel" data-index="'+i[d].goods_id+'"><i>&#xe6c5;</i><p>取消收藏</p></div><a href="'+Pub.getHtmlUrl("html/goods/cont.fb80c266.html")+"?id="+i[d].goods_id+'"><div class="img"><span></span><img src="'+i[d].goods_img+'"></div><div class="info"><div class="name">'+i[d].goods_name+'</div><div class="brief"><h5>'+i[d].goods_brief+'</h5></div><div class="tag">',1==i[d].is_hot&&(t+='<span class="hot">热卖</span>'),1==i[d].is_new&&(t+='<span class="new">新品</span>'),t+='</div><div class="price"><span>￥'+i[d].goods_price+"</span><del>￥"+i[d].market_price+"</del><em>评论"+i[d].comment_count+"条</em></div></div></a></li>",s.params.offset>=s.params.count&&(o.lock("down"),o.noData());a("#favorites_list").append(t),o.resetload()}0===parseInt(s.params.count)&&(a("#list").append('<div class="nothing">暂无数据！</div>'),a("#list").siblings().remove())},loadData:function(){var o=this;a("#favorites").dropload({scrollArea:window,domUp:{domClass:"dropload-up",domRefresh:'<div class="dropload-refresh">↓下拉刷新</div>',domUpdate:'<div class="dropload-update">↑释放刷新</div>',domLoad:'<div class="dropload-load"><span class="loading"></span>刷新中...</div>'},domDown:{domClass:"dropload-down",domRefresh:'<div class="dropload-refresh">↑上拉加载更多</div>',domLoad:'<div class="dropload-load"><span class="loading"></span>数据加载中...</div>',domNoData:'<div class="dropload-noData">数据已全部加载！</div>'},loadUpFn:function(a){setTimeout(function(){window.location.reload()},1e3),a.resetload(),a.unlock(),a.noData(!1)},loadDownFn:function(a){o.getData(a)},threshold:150,autoLoad:!0,distance:50})},initEvent:function(){a(".favorites-cancel").on("click",function(){var o=a(this).attr("data-index"),i=this;cloud.asked("您确定要取消收藏吗？",function(){Pub.post("/Home/Collect/cancel",{goods_id:o},function(o){0==o.error_code&&(cloud.explain("您已取消收藏！","success",1500),a(i).parent().fadeOut())})},function(){cloud.msg("您选择了取消！","50%",1500)})})}},new i}(jQuery);